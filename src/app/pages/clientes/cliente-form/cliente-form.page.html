<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/clientes"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ isEditMode ? 'Editar Cliente' : 'Nuevo Cliente' }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="container">
    <ion-card>
      <ion-card-content>
        <form [formGroup]="clienteForm" (ngSubmit)="onSubmit()">
          
          <ion-item>
            <ion-label position="stacked">Nombre completo *</ion-label>
            <ion-input 
              type="text" 
              formControlName="nombre"
              placeholder="Juan Pérez"
            ></ion-input>
          </ion-item>
          <ion-text color="danger" *ngIf="clienteForm.get('nombre')?.touched && clienteForm.get('nombre')?.errors">
            <p class="error-text">El nombre es requerido (mínimo 3 caracteres)</p>
          </ion-text>

          <ion-item>
            <ion-label position="stacked">Teléfono *</ion-label>
            <ion-input 
              type="tel" 
              formControlName="telefono"
              placeholder="3205551234"
            ></ion-input>
          </ion-item>
          <ion-text color="danger" *ngIf="clienteForm.get('telefono')?.touched && clienteForm.get('telefono')?.errors">
            <p class="error-text">Ingrese un teléfono válido (10 dígitos)</p>
          </ion-text>

          <ion-item>
            <ion-label position="stacked">Correo electrónico</ion-label>
            <ion-input 
              type="email" 
              formControlName="email"
              placeholder="cliente@email.com"
            ></ion-input>
          </ion-item>
          <ion-text color="danger" *ngIf="clienteForm.get('email')?.touched && clienteForm.get('email')?.errors">
            <p class="error-text">Ingrese un correo válido</p>
          </ion-text>

          <ion-item>
            <ion-label position="stacked">Dirección</ion-label>
            <ion-input 
              type="text" 
              formControlName="direccion"
              placeholder="Calle 123 #45-67"
            ></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Observaciones</ion-label>
            <ion-textarea 
              formControlName="observaciones"
              rows="3"
              placeholder="Notas adicionales sobre el cliente..."
            ></ion-textarea>
          </ion-item>

          <ion-button 
            expand="block" 
            type="submit" 
            [disabled]="clienteForm.invalid || loading"
            class="submit-btn"
          >
            <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
            <span *ngIf="!loading">
              {{ isEditMode ? 'Actualizar Cliente' : 'Crear Cliente' }}
            </span>
          </ion-button>

          <ion-button 
            expand="block" 
            fill="outline" 
            (click)="goBack()"
            [disabled]="loading"
          >
            Cancelar
          </ion-button>

        </form>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>